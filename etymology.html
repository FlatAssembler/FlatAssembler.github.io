<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
  <head>
    <title>Etymology Game</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>

  <body>
    If your browser can handle it, you should probably use the
    <a href="etymologist.html">flashcard-based</a> version. This is the
    text-based version. I guess you also may be interested in the
    <a href="Fonoloska_evolucija_jezika.docx">paper about Etymology Game</a> I
    have written in Croatian.
    <div id="tekst"></div>
    <script type="text/javascript">
      if (typeof Array.prototype.indexOf !== "function") {
        Array.prototype.indexOf = function (searchedFor) {
          for (var i = 0; i < this.length; i++)
            if (this[i] == searchedFor) return i;
          return -1;
        };
      }
      var tekst = document.getElementById("tekst");
      var vowels = "aeiou";
      var consonants = "bcdfghjklmnpqrstvwxyz";
      var allowed_beginning_consonant_clusters = [
        "sq",
        "st",
        "ts",
        "sk",
        "ks",
        "zd",
        "dz",
        "th",
        "tr",
        "dr",
        "bl",
        "fl",
        "sw",
        "sv",
        "sn",
        "sm",
        "hw",
        "br",
        "pr",
        "tw",
        "dw",
        "wr",
        "vr",
        "kr",
        "pl",
        "fr",
        "gr",
        "xr",
        "xt",
        "sl",
        "sr",
        "tn",
        "pt",
        "pn",
        "pm",
        "pl",
        "ky",
        "ty",
        "gn",
        "bh",
        "ph",
        "dh",
        "zl",
        "zr",
        "tk",
        "kt",
        "sp",
        "zb",
        "kl",
        "ps",
        "tf",
        "by",
        "kn",
        "py",
        "zw",
        "zv",
        "pw",
        "gy",
        "dv",
        "dw",
        "pf",
        "hy",
        "ml",
        "xp",
        "gw",
        "gv",
        "xw",
        "sf",
        "tl",
        "mn",
        "dn",
        "dm",
        "bh",
        "dh",
        "gh"
      ];
      var allowed_ending_consonant_clusters = [];
      for (var i = 0; i < allowed_beginning_consonant_clusters.length; i++)
        if (allowed_beginning_consonant_clusters[i].substr(1, 1) !== "q")
          allowed_ending_consonant_clusters.push(
            allowed_beginning_consonant_clusters[i].substr(1, 1) +
              allowed_beginning_consonant_clusters[i].substr(0, 1)
          );
      function syllable() {
        var ret = vowels.charAt(Math.floor(Math.random() * vowels.length));
        if (Math.random() < 0.5) {
          ret += consonants.charAt(
            Math.floor(Math.random() * consonants.length)
          );
          if (Math.random() > 0.75) {
            var znak = consonants.charAt(
              Math.floor(Math.random() * consonants.length)
            );
            while (
              znak === "w" ||
              znak === "y" || //suglasnik+y i suglasnik+w na kraju rijeci tesko se izgovaraju...
              znak === "j" ||
              ret.charAt(ret.length - 1) == znak || //...kao i dugi suglasnici na kraju rijeci.
              (znak === "p" && ret.charAt(ret.length - 1) === "b") ||
              (znak === "t" && ret.charAt(ret.length - 1) === "d") ||
              (znak === "b" && ret.charAt(ret.length - 1) === "p") ||
              (znak === "d" && ret.charAt(ret.length - 1) === "t") ||
              (znak === "s" && ret.charAt(ret.length - 1) === "z") ||
              (znak === "z" && ret.charAt(ret.length - 1) === "s")
            )
              znak = consonants.charAt(
                Math.floor(Math.random() * consonants.length)
              );
            ret += znak;
          }
        }
        if (Math.random() < 0.75) {
          ret =
            consonants.charAt(Math.floor(Math.random() * consonants.length)) +
            ret;
          if (Math.random() > 0.75) {
            var znak = consonants.charAt(
              Math.floor(Math.random() * consonants.length)
            );
            while (
              znak === "w" ||
              znak === "y" ||
              znak === "j" ||
              znak === "f" ||
              ((znak === "v" || znak === "h") &&
                ret.substr(0, 1) !== "l" &&
                ret.substr(0, 1) !== "r") ||
              znak === ret.charAt(0) || //Dugi suglasnik ne moze biti na pocetku rijeci.
              znak === "l" ||
              znak === "r" ||
              znak === "n" ||
              (znak === "m" &&
                ret.substr(0, 1) !== "b" &&
                ret.substr(0, 1) !== "p") || //Malo lakse za izgovoriti, ali svejedno tesko.
              (znak === "p" && ret.substr(0, 1) === "b") ||
              (znak === "t" && ret.substr(0, 1) === "d") ||
              (znak === "b" && ret.substr(0, 1) === "p") ||
              (znak === "d" && ret.substr(0, 1) === "t") ||
              (znak === "s" && ret.substr(0, 1) === "z") ||
              (znak === "z" && ret.substr(0, 1) === "s")
            )
              znak = consonants.charAt(
                Math.floor(Math.random() * consonants.length)
              );
            ret = znak + ret;
          }
        }
        return ret;
      }
      function randomWord() {
        var ret = syllable();
        if (Math.random() > 0.9) {
          ret += syllable();
          if (Math.random() > 0.9) ret += syllable();
        }
        if (ret.length < 12) return ret;
        return randomWord();
      }
      var original = [],
        brojPromjenaURijeci = [];
      for (var i = 0; i < 1024; i++) {
        var rijec, brojac;
        do {
          brojac = 0;
          rijec = randomWord();
          for (var j = 0; j < i; j++) if (original[j] === rijec) brojac++;
        } while (brojac !== 0);
        original.push(rijec);
        brojPromjenaURijeci.push(0);
      }
      var fonologija = [];
      fonologija[0] = "0[w]C>0, C[w]0>0, 0[y]C>0, C[y]0>0, 0[C1]C1>0 ";
      fonologija[1] = "";
      fonologija[2] = "";
      var abeceda = "abcdefghijklmnopqrstuvwxyz";
      var promjene = [];
      promjene[0] = [
        "e",
        "e",
        "ei",
        "ia",
        "o",
        "ua",
        "i",
        "u",
        "ar",
        "er",
        "ia",
        "-"
      ]; //U koje ce se glasove najvjerojatnije promijeniti 'a'.
      promjene[1] = [
        "p",
        "p",
        "p",
        "v",
        "v",
        "v",
        "f",
        "f",
        "f",
        "d",
        "-",
        "-"
      ]; //-||- 'b'
      promjene[2] = [
        "s",
        "s",
        "s",
        "k",
        "k",
        "k",
        "h",
        "h",
        "g",
        "x",
        "-",
        "-"
      ]; //-||- 'c'
      promjene[3] = [
        "t",
        "t",
        "f",
        "f",
        "b",
        "b",
        "r",
        "r",
        "t",
        "th",
        "-",
        "-"
      ]; //-||- 'd'
      promjene[4] = [
        "i",
        "i",
        "ie",
        "ei",
        "0",
        "y",
        "a",
        "o",
        "u",
        "0",
        "ei",
        "-"
      ]; //-||- 'e'
      promjene[5] = [
        "v",
        "v",
        "b",
        "h",
        "h",
        "h",
        "w",
        "w",
        "p",
        "p",
        "-",
        "-"
      ]; //-||- 'f'
      promjene[6] = [
        "k",
        "k",
        "y",
        "h",
        "w",
        "j",
        "y",
        "z",
        "z",
        "zy",
        "-",
        "-"
      ]; //-||- 'g'
      promjene[7] = [
        "s",
        "s",
        "x",
        "a",
        "w",
        "f",
        "f",
        "k",
        "0",
        "0",
        "-",
        "-"
      ]; //-||- 'h'
      promjene[8] = [
        "a",
        "a",
        "ai",
        "yi",
        "iy",
        "u",
        "e",
        "ie",
        "ei",
        "a",
        "o",
        "-"
      ]; //-||- 'i'
      promjene[9] = [
        "z",
        "z",
        "z",
        "y",
        "y",
        "y",
        "h",
        "h",
        "h",
        "l",
        "-",
        "-"
      ]; //-||- 'j'
      promjene[10] = [
        "c",
        "c",
        "p",
        "s",
        "s",
        "p",
        "g",
        "h",
        "h",
        "qu",
        "-",
        "-"
      ]; //-||- 'k'
      promjene[11] = [
        "y",
        "y",
        "s",
        "j",
        "j",
        "a",
        "a",
        "o",
        "0",
        "i",
        "-",
        "-"
      ]; //-||- 'l'
      promjene[12] = [
        "n",
        "n",
        "n",
        "b",
        "b",
        "bh",
        "a",
        "a",
        "0",
        "f",
        "-",
        "-"
      ]; //-||- 'm'
      promjene[13] = [
        "t",
        "t",
        "d",
        "d",
        "m",
        "r",
        "l",
        "l",
        "0",
        "r",
        "-",
        "-"
      ]; //-||- 'n'
      promjene[14] = [
        "u",
        "u",
        "ou",
        "a",
        "a",
        "a",
        "e",
        "e",
        "i",
        "ow",
        "uo",
        "-"
      ]; //-||- 'o'
      promjene[15] = [
        "b",
        "b",
        "b",
        "f",
        "f",
        "qu",
        "pf",
        "pf",
        "ph",
        "h",
        "-",
        "-"
      ]; //-||- 'p'
      promjene[16] = [
        "h",
        "h",
        "k",
        "k",
        "w",
        "w",
        "v",
        "z",
        "s",
        "g",
        "-",
        "-"
      ]; //-||- 'q'
      promjene[17] = [
        "a",
        "a",
        "n",
        "l",
        "v",
        "t",
        "0",
        "0",
        "0",
        "l",
        "-",
        "-"
      ]; //-||- 'r'
      promjene[18] = [
        "z",
        "z",
        "z",
        "x",
        "r",
        "r",
        "h",
        "h",
        "x",
        "c",
        "-",
        "-"
      ]; //-||- 's'
      promjene[19] = [
        "th",
        "th",
        "c",
        "r",
        "r",
        "d",
        "d",
        "ts",
        "0",
        "ty",
        "-",
        "-"
      ]; //-||- 't'
      promjene[20] = [
        "wu",
        "uw",
        "iu",
        "yu",
        "vu",
        "o",
        "a",
        "a",
        "-",
        "i",
        "ou",
        "-"
      ]; //-||- 'u'
      promjene[21] = [
        "w",
        "w",
        "w",
        "u",
        "u",
        "u",
        "b",
        "b",
        "p",
        "l",
        "-",
        "-"
      ]; //-||- 'v'
      promjene[22] = [
        "v",
        "v",
        "v",
        "u",
        "u",
        "p",
        "p",
        "b",
        "b",
        "h",
        "-",
        "-"
      ]; //-||- 'w'
      promjene[23] = [
        "s",
        "s",
        "si",
        "c",
        "c",
        "c",
        "z",
        "z",
        "z",
        "k",
        "-",
        "-"
      ]; //-||- 'x'
      promjene[24] = [
        "j",
        "j",
        "u",
        "e",
        "z",
        "dz",
        "i",
        "i",
        "i",
        "di",
        "-",
        "-"
      ]; //-||- 'y'
      promjene[25] = [
        "r",
        "r",
        "r",
        "y",
        "j",
        "j",
        "dz",
        "dz",
        "ts",
        "s",
        "-",
        "-"
      ]; //-||- 'z'
      function mySort(prvi, drugi) {
        return drugi.length - prvi.length;
      }
      original.sort(mySort);
      var language1 = [],
        language2 = [];
      for (var i = 0; i < original.length; i++)
        language1[i] = language2[i] = original[i];
      var uvjeti = "VCN0-VC0";
      function primjeniPromjenu(nakon, prvi, prije, drugi, rijec) {
        for (var i = 0; i < rijec.length; i++) {
          if (
            (nakon !== "0" || i === 0) && //Glasovna promjena zahvaca samo glasove na pocetku rijeci.
            (prije !== "0" || i === rijec.length - 1) && //Samo na kraju rijeci.
            (nakon !== "N" ||
              rijec.charAt(i - 1) === "m" ||
              rijec.charAt(i - 1) === "n") && //Nakon nazalnog suglasnika.
            (prije !== "N" ||
              rijec.charAt(i + 1) === "m" ||
              rijec.charAt(i + 1) === "n") && //Prije nazalnog suglasnika.
            (nakon !== "V" || vowels.search(rijec.charAt(i - 1)) !== -1) && //Nakon samoglasnika
            (prije !== "V" || vowels.search(rijec.charAt(i + 1)) !== -1) && //Prije samoglasnika
            (prije !== "C" || consonants.search(rijec.charAt(i + 1)) !== -1) && //Prije suglasnika
            (nakon !== "C" || consonants.search(rijec.charAt(i - 1)) !== -1) && //Nakon suglasnika
            (nakon === rijec.charAt(i - 1) ||
              nakon === "Z" ||
              nakon === "0" ||
              nakon === "C" ||
              nakon === "N" ||
              nakon === "V") && //Rijetke glasovne promjene koje se dogadaju samo nakon nekog odredenog glasa
            (prije === rijec.charAt(i + 1) ||
              prije === "Z" ||
              prije === "0" ||
              prije === "C" ||
              prije === "N" ||
              prije === "V") && //One koje se dogadaju samo prije tog glasa
            rijec.charAt(i) === prvi
          ) {
            var novi = rijec.slice(0, i);
            if (drugi !== "0") novi += drugi;
            novi += rijec.slice(i + 1);
            if (drugi === "0") i--;
            rijec = novi;
            i += drugi.length - 1;
          }
        }
        return rijec;
      }
      var BrojSimuliranihPromjena = 11;
      for (var i = 0; i < BrojSimuliranihPromjena * 2; i++) {
        var prije;
        if (Math.random() < 0.5) prije = "Z";
        //Bezuvjetna glasovna promjena.
        else prije = uvjeti.charAt(Math.floor(Math.random() * uvjeti.length));
        if (prije === "-")
          prije = abeceda.charAt(Math.floor(Math.random() * abeceda.length));
        var nakon;
        if (
          (prije != "Z" && Math.random() < 0.75) ||
          (prije == "Z" && Math.random() < 0.25)
        )
          nakon = "Z";
        else nakon = uvjeti.charAt(Math.floor(Math.random() * uvjeti.length));
        if (nakon === "-")
          nakon = abeceda.charAt(Math.floor(Math.random() * abeceda.length));
        var prvi = Math.floor(Math.random() * 26);
        var drugi;
        var jesmoLiOdabraliZamijenuZaPrvi = false;
        for (var j = 0; j < 12; j++) {
          var fonem = promjene[prvi][j];
          if (fonem == "-" || fonem == "0") continue;
          var nalaziLiSeFonemUJeziku = false;
          if (i < BrojSimuliranihPromjena) {
            for (var k = 0; k < language1.length; k++)
              if (language1[k].indexOf(fonem) + 1) {
                nalaziLiSeFonemUJeziku = true;
                break;
              }
          } else {
            for (var k = 0; k < language2.length; k++)
              if (language2[k].indexOf(fonem) + 1) {
                nalaziLiSeFonemUJeziku = true;
                break;
              }
          }
          if (nalaziLiSeFonemUJeziku) continue;
          jesmoLiOdabraliZamijenuZaPrvi = true;
          drugi = fonem;
          break;
        }
        if (!jesmoLiOdabraliZamijenuZaPrvi)
          drugi = promjene[prvi][Math.floor(Math.random() * 12)];
        if (drugi === "-") {
          var jeLiFonologijaURavnotezi = true;
          for (var k = 0; k <= abeceda.length; k++) {
            var fonem = abeceda.charAt(k);
            var nalaziLiSeFonemUJeziku = false;
            if (i < BrojSimuliranihPromjena) {
              for (var j = 0; j < language1.length; j++)
                if (language1[j].indexOf(fonem) + 1) {
                  nalaziLiSeFonemUJeziku = true;
                  break;
                }
            } else {
              for (var j = 0; j < language2.length; j++)
                if (language2[j].indexOf(fonem) + 1) {
                  nalaziLiSeFonemUJeziku = true;
                  break;
                }
            }
            if (nalaziLiSeFonemUJeziku) continue;
            jeLiFonologijaURavnotezi = false;
            drugi = fonem;
            break;
          }
          if (jeLiFonologijaURavnotezi)
            drugi = abeceda.charAt(Math.floor(Math.random() * abeceda.length));
        }
        prvi = String.fromCharCode(prvi + 97);
        if (
          i >= BrojSimuliranihPromjena &&
          fonologija[1].indexOf(
            (nakon === "Z" ? "" : nakon) +
              "[" +
              prvi +
              "]" +
              (prije === "Z" ? "" : prije) +
              ">" +
              drugi
          ) + 1
        ) {
          //Ne daj da se iste promjene dogode u oba simulirana jezika
          i--;
          continue;
        }
        if (i < BrojSimuliranihPromjena) {
          var promjenjeno = false;
          for (var j = 0; j < language1.length; j++) {
            var prijasnji = language1[j];
            language1[j] = primjeniPromjenu(
              nakon,
              prvi,
              prije,
              drugi,
              language1[j]
            );
            if (language1[j] != prijasnji) {
              promjenjeno = true;
              brojPromjenaURijeci[j]++;
            }
          }
          if (!promjenjeno) i--;
          else
            fonologija[1] +=
              (nakon === "Z" ? "" : nakon) +
              "[" +
              prvi +
              "]" +
              (prije === "Z" ? "" : prije) +
              ">" +
              drugi +
              ", ";
        } else {
          var promjenjeno = false;
          for (var j = 0; j < language2.length; j++) {
            var prijasnji = language2[j];
            language2[j] = primjeniPromjenu(
              nakon,
              prvi,
              prije,
              drugi,
              language2[j]
            );
            if (language2[j] != prijasnji) {
              promjenjeno = true;
              brojPromjenaURijeci[j]++;
            }
          }
          if (!promjenjeno) i--;
          else
            fonologija[2] +=
              (nakon === "Z" ? "" : nakon) +
              "[" +
              prvi +
              "]" +
              (prije === "Z" ? "" : prije) +
              ">" +
              drugi +
              ", ";
        }
      }
      var allowed_beginning_consonant_clusters_in_first_language = [];
      for (var i = 0; i < allowed_beginning_consonant_clusters.length; i++)
        if (Math.random() < 0.5)
          allowed_beginning_consonant_clusters_in_first_language.push(
            allowed_beginning_consonant_clusters[i]
          );
      var allowed_ending_consonant_clusters_in_first_language = [];
      for (var i = 0; i < allowed_ending_consonant_clusters.length; i++)
        if (Math.random() < 0.5)
          allowed_ending_consonant_clusters_in_first_language.push(
            allowed_ending_consonant_clusters[i]
          );
      var allowed_beginning_consonant_clusters_in_second_language = [];
      for (var i = 0; i < allowed_beginning_consonant_clusters.length; i++)
        if (Math.random() < 0.5)
          allowed_beginning_consonant_clusters_in_second_language.push(
            allowed_beginning_consonant_clusters[i]
          );
      var allowed_ending_consonant_clusters_in_second_language = [];
      for (var i = 0; i < allowed_ending_consonant_clusters.length; i++)
        if (Math.random() < 0.5)
          allowed_ending_consonant_clusters_in_second_language.push(
            allowed_ending_consonant_clusters[i]
          );
      var jesmoLiOdabraliEpentetskiVokal = false;
      var epenteza1;
      for (var i = 0; i < vowels.length; i++) {
        var samoglasnik = vowels.charAt(i);
        var nalaziLiSeFonemUJeziku = false;
        for (var j = 0; j < language1.length; j++)
          if (language1[j].indexOf(samoglasnik) + 1) {
            nalaziLiSeFonemUJeziku = true;
            break;
          }
        if (!nalaziLiSeFonemUJeziku) {
          epenteza1 = samoglasnik;
          jesmoLiOdabraliEpentetskiVokal = true;
          break;
        }
      }
      if (!jesmoLiOdabraliEpentetskiVokal)
        epenteza1 = vowels.charAt(Math.floor(Math.random() * vowels.length));
      jesmoLiOdabraliEpentetskiVokal = false;
      var epenteza2;
      for (var i = 0; i < vowels.length; i++) {
        var samoglasnik = vowels.charAt(i);
        var nalaziLiSeFonemUJeziku = false;
        for (var j = 0; j < language2.length; j++)
          if (language2[j].indexOf(samoglasnik) + 1) {
            nalaziLiSeFonemUJeziku = true;
            break;
          }
        if (!nalaziLiSeFonemUJeziku) {
          epenteza2 = samoglasnik;
          jesmoLiOdabraliEpentetskiVokal = true;
          break;
        }
      }
      if (!jesmoLiOdabraliEpentetskiVokal)
        epenteza2 = vowels.charAt(Math.floor(Math.random() * vowels.length));
      fonologija[1] += "CCC>C" + epenteza1 + "CC";
      fonologija[2] += "CCC>C" + epenteza2 + "CC";
      //Jednostavna fonotaktika: ne dopusti tri suglasnika za redom i ne dopusti q+suglasnik.
      for (var i = 0; i < language1.length; i++) {
        if (language1[i].charAt(language1[i].length - 1) == "q")
          language1[i] += epenteza1;
        if (
          consonants.search(language1[i].charAt(0)) !== -1 &&
          consonants.search(language1[i].charAt(1)) !== -1 &&
          allowed_beginning_consonant_clusters_in_first_language.indexOf(
            language1[i].substr(0, 2)
          ) === -1
        )
          language1[i] = epenteza1 + language1[i];
        if (
          consonants.search(language1[i].charAt(language1[i].length - 1)) !==
            -1 &&
          consonants.search(language1[i].charAt(language1[i].length - 2)) !==
            -1 &&
          allowed_ending_consonant_clusters_in_first_language.indexOf(
            language1[i].substr(language1[i].length - 2, 2)
          ) === -1
        )
          language1[i] += epenteza1;
        for (var j = 1; j < language1[i].length - 1; j++)
          if (
            (consonants.search(language1[i].charAt(j - 1)) !== -1 &&
              consonants.search(language1[i].charAt(j)) !== -1 &&
              consonants.search(language1[i].charAt(j + 1)) !== -1) ||
            (consonants.search(language1[i].charAt(j)) !== -1 &&
              language1[i].charAt(j - 1) === "q")
          )
            language1[i] =
              language1[i].slice(0, j) + epenteza1 + language1[i].slice(j);
      }
      for (var i = 0; i < language2.length; i++) {
        if (language2[i].charAt(language2[i].length - 1) == "q")
          language2[i] += epenteza2;
        if (
          consonants.search(language2[i].charAt(0)) !== -1 &&
          consonants.search(language2[i].charAt(1)) !== -1 &&
          allowed_beginning_consonant_clusters_in_second_language.indexOf(
            language2[i].substr(0, 2)
          ) === -1
        )
          language2[i] = epenteza2 + language2[i];
        if (
          consonants.search(language2[i].charAt(language2[i].length - 1)) !==
            -1 &&
          consonants.search(language2[i].charAt(language2[i].length - 2)) !==
            -1 &&
          allowed_ending_consonant_clusters_in_second_language.indexOf(
            language2[i].substr(language2[i].length - 2, 2)
          ) === -1
        )
          language2[i] += epenteza2;
        for (var j = 1; j < language2[i].length - 1; j++)
          if (
            (consonants.search(language2[i].charAt(j - 1)) !== -1 &&
              consonants.search(language2[i].charAt(j)) !== -1 &&
              consonants.search(language2[i].charAt(j + 1)) !== -1) ||
            (consonants.search(language2[i].charAt(j)) !== -1 &&
              language2[i].charAt(j - 1) === "q")
          )
            language2[i] =
              language2[i].slice(0, j) + epenteza2 + language2[i].slice(j);
      }
      //Redukcija vokala.
      for (var i = 0; i < language1.length; i++) {
        var jaka = false;
        if (language1[i].length > 8) {
          language1[i] = language1[i].replace(/y/g, "i");
          language1[i] = language1[i].replace(/w/g, "u");
          language1[i] = language1[i].replace(/v/g, "u");
          jaka = true;
        }
        for (var j = 0; j < language1[i].length; j++)
          if (
            (vowels.search(language1[i].charAt(j)) !== -1 &&
              language1[i].charAt(j - 1) !== "q" &&
              (!jaka
                ? language1[i].charAt(j) === language1[i].charAt(j - 2)
                : vowels.search(language1[i].charAt(j - 2)) !== -1) &&
              (!jaka
                ? language1[i].charAt(j) === language1[i].charAt(j + 2)
                : vowels.search(language1[i].charAt(j + 2)) !== -1)) ||
            (jaka &&
              vowels.search(language1[i].charAt(j)) !== -1 &&
              language1[i].charAt(j - 1) !== "q" &&
              (vowels.search(language1[i].charAt(j - 1)) !== -1 ||
                vowels.search(language1[i].charAt(j + 1)) !== -1)) ||
            (jaka && language1[i].charAt(j) === language1[i].charAt(j - 1))
          ) {
            language1[i] = language1[i].slice(0, j) + language1[i].slice(j + 1);
            j--;
          }
        if (
          consonants.search(language1[i].charAt(language1[i].length - 1)) !==
            -1 &&
          consonants.search(language1[i].charAt(language1[i].length - 2)) !==
            -1 &&
          allowed_ending_consonant_clusters_in_first_language.indexOf(
            language1[i].substr(language1[i].length - 2, 2)
          ) === -1
        )
          language1[i] += epenteza1;
        if (
          consonants.search(language1[i].charAt(0)) !== -1 &&
          consonants.search(language1[i].charAt(1)) !== -1 &&
          allowed_beginning_consonant_clusters_in_first_language.indexOf(
            language1[i].substr(0, 2)
          ) === -1
        )
          language1[i] = epenteza1 + language1[i];
      }
      for (var i = 0; i < language2.length; i++) {
        var jaka = false;
        if (language2[i].length > 8) {
          language2[i] = language2[i].replace(/y/g, "i");
          language2[i] = language2[i].replace(/w/g, "u");
          language2[i] = language2[i].replace(/v/g, "u");
          jaka = true;
        }
        for (var j = 0; j < language2[i].length; j++)
          if (
            (vowels.search(language2[i].charAt(j)) !== -1 &&
              language2[i].charAt(j - 1) !== "q" &&
              (!jaka
                ? language2[i].charAt(j) === language2[i].charAt(j - 2)
                : vowels.search(language2[i].charAt(j - 2)) !== -1) &&
              (!jaka
                ? language2[i].charAt(j) === language2[i].charAt(j + 2)
                : vowels.search(language2[i].charAt(j + 2)) !== -1)) ||
            (jaka &&
              vowels.search(language2[i].charAt(j)) !== -1 &&
              language2[i].charAt(j - 1) !== "q" &&
              (vowels.search(language2[i].charAt(j - 1)) !== -1 ||
                vowels.search(language2[i].charAt(j + 1)) !== -1)) ||
            (jaka && language2[i].charAt(j) === language2[i].charAt(j - 1))
          ) {
            language2[i] = language2[i].slice(0, j) + language2[i].slice(j + 1);
            j--;
          }
        if (
          consonants.search(language2[i].charAt(language2[i].length - 1)) !==
            -1 &&
          consonants.search(language2[i].charAt(language2[i].length - 2)) !==
            -1 &&
          allowed_ending_consonant_clusters_in_second_language.indexOf(
            language2[i].substr(language2[i].length - 2, 2)
          ) === -1
        )
          language2[i] += epenteza2;
        if (
          consonants.search(language2[i].charAt(0)) !== -1 &&
          consonants.search(language2[i].charAt(1)) !== -1 &&
          allowed_beginning_consonant_clusters_in_second_language.indexOf(
            language2[i].substr(0, 2)
          ) === -1
        )
          language2[i] = epenteza2 + language2[i];
      }
      for (var i = 0; i < language1.length; i++) {
        for (var j = 0; j < vowels.length; j++)
          language1[i] = language1[i].replace(
            RegExp("ii" + vowels.charAt(j), "g"),
            "iy" + vowels.charAt(j)
          );
        for (var j = 0; j < vowels.length; j++)
          language1[i] = language1[i].replace(
            RegExp(vowels.charAt(j) + "ii", "g"),
            vowels.charAt(j) + "yi"
          );
        for (var j = 0; j < vowels.length; j++)
          language1[i] = language1[i].replace(
            RegExp("uu" + vowels.charAt(j), "g"),
            "uw" + vowels.charAt(j)
          );
        for (var j = 0; j < vowels.length; j++)
          language1[i] = language1[i].replace(
            RegExp(vowels.charAt(j) + "uu", "g"),
            vowels.charAt(j) + "wu"
          );
        language1[i] = language1[i].replace(/yy/g, "iy");
        language1[i] = language1[i].replace(/ww/g, "uw");
      }
      for (var i = 0; i < language2.length; i++) {
        for (var j = 0; j < vowels.length; j++)
          language2[i] = language2[i].replace(
            RegExp("ii" + vowels.charAt(j), "g"),
            "iy" + vowels.charAt(j)
          );
        for (var j = 0; j < vowels.length; j++)
          language2[i] = language2[i].replace(
            RegExp(vowels.charAt(j) + "ii", "g"),
            vowels.charAt(j) + "yi"
          );
        for (var j = 0; j < vowels.length; j++)
          language2[i] = language2[i].replace(
            RegExp("uu" + vowels.charAt(j), "g"),
            "uw" + vowels.charAt(j)
          );
        for (var j = 0; j < vowels.length; j++)
          language2[i] = language2[i].replace(
            RegExp(vowels.charAt(j) + "uu", "g"),
            vowels.charAt(j) + "wu"
          );
        language2[i] = language2[i].replace(/yy/g, "yi");
        language2[i] = language2[i].replace(/ww/g, "wu");
      }
      tekst.appendChild(
        document.createTextNode(
          "Introduction: One phoneme in one language corresponds to other phoneme in a related language. For instance, the English 't' in the beginning of a word corresponds to German 'z'. For example: two-zwei, ten-zehn, tooth-Zahn, tongue-Zunge, twig-Zweig, toe-Zeh, too-zu, tame-zahm... This game randomly generates words as if they were in two related languages."
        )
      );
      for (var i = 0; i < 2; i++)
        tekst.appendChild(document.createElement("br"));
      tekst.appendChild(
        document.createTextNode(
          "SUMMARY: The game has three parts. In the Part #1, you are supposed to find which words from the simulated languages are cognates. In the Part #2, you are supposed to find which words belong to which language. In the Part #3, you are supposed to find which set of sound changes belongs to which language."
        )
      );
      for (var i = 0; i < 3; i++)
        tekst.appendChild(document.createElement("br"));
      tekst.appendChild(
        document.createTextNode(
          "Part 1: Here are two randomly generated related languages. Choose the word in the second language that shares the same root as the specified word in the first one."
        )
      );
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(
        document.createTextNode(
          "Example: Choose the correct cognate to 'twig':"
        )
      );
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("A) sonne"));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("B) bett"));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("C) zweig"));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("D) traum"));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(
        document.createTextNode(
          "Solution: The solution is 'zweig'. Namely, if you didn't guess, the languages in this example were English and German (in further tasks, they will be simulated languages). The specified word, 'twig', is in English. It starts with a 't'. The English 't' in the beginning of a word corresponds to German 'z'. Only one of the presented German words start with a 'z', it's 'zweig'. Note that 'traum', for example, can't be a cognate, because English 't' in the beginning of a word corresponds to German 'z', and not to a 't'. If both English and German word meaning the same start with a 't', it's probably a result of borrowing (like both languages borrowing the word from Latin). This game doesn't simulate borrowing."
        )
      );
      for (var i = 0; i < 2; i++)
        tekst.appendChild(document.createElement("br"));
      var koristeno = [];
      for (var i = 0; i < 26; i++) {
        tekst.appendChild(
          document.createTextNode("Choose the correct cognate to '")
        );
        var rjesenje, iskoristen;
        do {
          iskoristen = false;
          rjesenje = Math.floor(Math.random() * original.length);
          for (var i = 0; i < koristeno.length; i++)
            if (original[rjesenje].charAt(0) == koristeno[i].charAt(0))
              iskoristen = true;
        } while (iskoristen);
        koristeno.push(original[rjesenje]);
        tekst.appendChild(document.createTextNode(language1[rjesenje] + "':"));
        tekst.appendChild(document.createElement("br"));
        var tocno = Math.floor(Math.random() * 4);
        for (var j = 0; j < 4; j++) {
          tekst.appendChild(
            document.createTextNode(String.fromCharCode(65 + j) + ")")
          );
          if (j !== tocno) {
            var slucajno;
            do {
              slucajno = Math.floor(Math.random() * language2.length);
            } while (language2[slucajno] === language2[rjesenje]);
            tekst.appendChild(document.createTextNode(language2[slucajno]));
          } else {
            tekst.appendChild(document.createTextNode(language2[rjesenje]));
          }
          tekst.appendChild(document.createElement("br"));
        }
        tekst.appendChild(
          document.createTextNode(
            "Solution: " +
              language2[rjesenje] +
              " (<*" +
              original[rjesenje] +
              ")"
          )
        );
        for (var j = 0; j < 2; j++)
          tekst.appendChild(document.createElement("br"));
      }
      tekst.appendChild(
        document.createTextNode(
          "Part 2: We hope you got familiar with the grammar of the two languages. Connect each word in the pairs to one of the two languages."
        )
      );
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(
        document.createTextNode(
          "Example: Connect each of the words in the pairs to the correct language:"
        )
      );
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("English: two"));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("German: zwei"));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(
        document.createTextNode(
          "(two,zwei) (zehn,ten) (twig,zweig) (traum,dream)"
        )
      );
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(
        document.createTextNode(
          "Solution: The words 'ten', 'two' and 'twig' belong to English while the words 'zweig', 'zwei' and 'zehn' belong to German, because there is a regular sound correspondence between English 't' and German 'z' in the beginning of a word  ('two'-'zwei', 'ten'-'zehn', 'tooth'-'Zahn', 'tongue'-'Zunge', 'twig'-'Zweig', 'toe'-'Zeh', 'too'-'zu', 'tame'-'zahm', 'token'-'Zeichen', 'twinkle'-'zwinkern', 'twilight'-'Zwielicht'...). The word 'traum' belongs to German while the word 'dream' belongs to English, because English 'd' corresponds to German 't' ('day'-'Tag', 'cold'-'kalt', 'old'-'alt', 'dream'-'Traum', 'red'-'rot', 'do'-'tun', 'death'-'Tod', 'dale'-'Tal', 'ride'-'reiten', 'blood'-'Blut', 'dew'-'Tau', 'deep'-'tief', 'good'-'gut', 'god'-'Gott', 'bed'-'Bett', 'drive'-'treiben', 'drink'-'trinken', 'drop'-'Tropfen', 'dove'-'Taube', 'deaf'-'taub', 'daughter'-'Tochter', 'bread'-'Brot', 'door'-'Tuer', 'word'-'Wort', 'world'-'Welt', 'shoulder'-'Schulter', 'hard'-'hart'...). If 'traum' was an English word, the German cognate would have to start with a 'z'."
        )
      );
      for (var i = 0; i < 2; i++)
        tekst.appendChild(document.createElement("br"));
      tekst.appendChild(
        document.createTextNode(
          "Connect each of the words in the pairs to the correct language:"
        )
      );
      tekst.appendChild(document.createElement("br"));
      var rijeci = [];
      for (var i = 1; i < 8; i++)
        do {
          rijeci[i] = Math.floor(Math.random() * original.length);
          var jesmoLiJeVecOdabrali = 0;
          for (var j = 0; j < i; j++)
            if (rijeci[i] == rijeci[j]) jesmoLiJeVecOdabrali++;
        } while (
          language1[rijeci[i]] == language2[rijeci[i]] ||
          jesmoLiJeVecOdabrali
        );
      tekst.appendChild(document.createTextNode("Roots: "));
      var primjer = 0;
      for (var i = 0; i < language1.length; i++)
        if (
          brojPromjenaURijeci[i] * Math.sqrt(original[i].length) >
          brojPromjenaURijeci[primjer] * Math.sqrt(original[primjer].length)
        )
          primjer = i;
      rijeci[0] = primjer;
      for (var i = 0; i < 8; i++)
        tekst.appendChild(
          document.createTextNode("*" + original[rijeci[i]] + " ")
        );
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(
        document.createTextNode("Language A: " + language1[primjer])
      );
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(
        document.createTextNode("Language B: " + language2[primjer])
      );
      tekst.appendChild(document.createElement("br"));
      for (var i = 0; i < 8; i++) {
        tekst.appendChild(document.createTextNode("("));
        if (Math.random() < 0.5)
          tekst.appendChild(
            document.createTextNode(
              language1[rijeci[i]] + "," + language2[rijeci[i]]
            )
          );
        else
          tekst.appendChild(
            document.createTextNode(
              language2[rijeci[i]] + "," + language1[rijeci[i]]
            )
          );
        tekst.appendChild(document.createTextNode(") "));
      }
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("Solution:"));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("Language A: "));
      for (var i = 0; i < 8; i++)
        tekst.appendChild(document.createTextNode(language1[rijeci[i]] + " "));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("Language B: "));
      for (var i = 0; i < 8; i++)
        tekst.appendChild(document.createTextNode(language2[rijeci[i]] + " "));
      for (var i = 0; i < 3; i++)
        tekst.appendChild(document.createElement("br"));
      tekst.appendChild(
        document.createTextNode(
          "Part 3: Here are three formally written descriptions of phonologies of the simulated languages, in a format that would be used by an actual linguist. Can you recognize which one belongs to which language?"
        )
      );
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(
        document.createTextNode(
          "Example: Connect the formal descriptions of the sound changes to the language they belong to:"
        )
      );
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("English:"));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("German:"));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("1) 0[t]>z"));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("2) V[b]V>v"));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(
        document.createTextNode(
          "Solution: The change '0[t]>z' belongs to German, because, in German, 't' in the beginning of a word changes into 'z'. The change 'V[b]V>v' belongs to English, because, in English, 'b' between two vowels turns to a 'v' (compare, for instance, English 'have' and German 'haben' or English 'give' and German 'geben' or the English bird name 'dove' and the corresponding German 'Taube')."
        )
      );
      for (var i = 0; i < 2; i++)
        tekst.appendChild(document.createElement("br"));
      tekst.appendChild(
        document.createTextNode(
          "Connect the formal descriptions of the sound changes to the language they belong to:"
        )
      );
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("Proto-language (the roots):"));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("Language A:"));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("Language B:"));
      tekst.appendChild(document.createElement("br"));
      var prvi = Math.floor(Math.random() * 3);
      var drugi;
      do {
        drugi = Math.floor(Math.random() * 3);
      } while (drugi === prvi);
      var treci;
      do {
        treci = Math.floor(Math.random() * 3);
      } while (treci === drugi || treci === prvi);
      tekst.appendChild(document.createTextNode("1) " + fonologija[prvi]));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("2) " + fonologija[drugi]));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("3) " + fonologija[treci]));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("Solution:"));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("Proto-language: "));
      if (prvi === 0) tekst.appendChild(document.createTextNode("1)"));
      else if (drugi === 0) tekst.appendChild(document.createTextNode("2)"));
      else tekst.appendChild(document.createTextNode("3)"));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("Language A: "));
      if (prvi === 1) tekst.appendChild(document.createTextNode("1)"));
      else if (drugi === 1) tekst.appendChild(document.createTextNode("2)"));
      else tekst.appendChild(document.createTextNode("3)"));
      tekst.appendChild(document.createElement("br"));
      tekst.appendChild(document.createTextNode("Language B: "));
      if (prvi === 2) tekst.appendChild(document.createTextNode("1)"));
      else if (drugi === 2) tekst.appendChild(document.createTextNode("2)"));
      else tekst.appendChild(document.createTextNode("3)"));
      tekst.appendChild(document.createElement("br"));
    </script>
  </body>
</html>
